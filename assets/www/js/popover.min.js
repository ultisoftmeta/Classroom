!function(d){var a={_init:function(e,f){if(typeof(e.backgroundColor)!=="undefined"){c.setBackgroundColor(e.backgroundColor)}if(typeof(e.fontColor)!=="undefined"){c.setFontColor(e.fontColor)}if(typeof(e.borderColor)!=="undefined"){c.setBorderColor(e.borderColor)}if(typeof(e.disableBackButton)!=="undefined"){if(e.disableBackButton===true){f.disableBackButton()}else{if(e.disableBackButton===false){f.enableBackButton()}}}if(typeof(e.enableBackButton)!=="undefined"){if(e.enableBackButton===true){f.enableBackButton()}else{if(e.enableBackButton===false){f.disableBackButton()}}}if(typeof(e.disableHeader)!=="undefined"){if(e.disableHeader===true){f.disableHeader()}else{if(e.disableHeader===false){f.enableHeader()}}}if(typeof(e.keepData)!=="undefined"){f.keepData(e.keepData)}if(typeof(e.childToAppend)!=="undefined"){f.childToAppend=e.childToAppend}if(typeof(e.onCreate)!=="undefined"){f._onCreate=e.onCreate}if(typeof(e.onVisible)!=="undefined"){f._onVisible=e.onVisible}c.addMenu(e.id,e.title,e.contents)},_popoverInit:function(e){var f=new c(this.selector);a._init(e,f);return f},_optionsPopoverInit:function(e){var f=new b(this.selector);a._init(e,f);return f},disableHeader:function(e){e.disableHeader()},enableHeader:function(e){e.enableHeader()},lockPopover:function(){c.lockPopover()},unlockPopover:function(){c.unlockPopover()},addMenu:function(e){c.addMenu(e.id,e.title,e.contents)},closePopover:function(){c.closePopover()},_getPopoverClass:function(){return c}};d.fn.optionsPopover=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a._optionsPopoverInit.apply(this,arguments)}else{d.error("Method "+e+" does not exist on jQuery.optionsPopover")}}return this.each(function(){})};d.fn.popover=function(e){if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a._popoverInit.apply(this,arguments)}else{d.error("Method "+e+" does not exist on jQuery.popover")}}return this.each(function(){})};function c(f){this.constructor=c;this.popoverNumber=++c.popoverNum;this.popoverListenerID="popoverListener"+this.popoverNumber;this.isHeaderDisabled=true;this.isDataKept=false;this.hasBeenOpened=false;var g=this;var e=d(f);e.addClass(this.popoverListenerID);e.css("cursor","pointer");e.click(function(h){g.toggleVisible(h,d(this));d(document).trigger("popover.listenerClicked")})}c.prototype.disableHeader=function(){this.isHeaderDisabled=true};c.prototype.enableHeader=function(){this.isHeaderDisabled=false};c.prototype.disablePopover=function(){this.isDisabled=true};c.prototype.enablePopover=function(){this.isDisabled=false};c.prototype.keepData=function(e){this.isDataKept=e};c.prototype.appendChild=function(){var e=this.childToAppend;if(!e){return}d("#popoverContent")[0].appendChild(e)};c.prototype.toggleVisible=function(h,g){c.lastPopoverClicked=this;var f=d(g);if(!f){console.log("ERROR: No element clicked!");return}var i=d("#popoverWrapper");if(i.length===0){i=this.createPopover();if(i.length===0){console.log("ERROR: Failed to create Popover!");return}}var l=f.attr("id");var k=f.attr("class").split(/\s+/);k.push(l);if(d("#popover").is(":visible")&&c.lastElementClick){if(f.is("#"+c.lastElementClick)){console.log("Clicked on same element!");console.log("Last clicked: "+c.lastElementClick);c.closePopover();return}console.log("Clicked on different element!");c.closePopover()}d("#popover").promise().done(function(){});if(c.isLocked||this.isDisabled){return}this.populate(k);f.trigger("popover.action",f);if(c.backgroundColor){d("#popoverHeader").css("backgroundColor",c.backgroundColor);d("#popoverContent").css("backgroundColor",c.backgroundColor)}if(c.fontColor){d("#popover").css("color",c.fontColor);d("#popover a").css("color",c.fontColor)}if(c.borderColor){d("#popoverHeader").css("border-color",c.borderColor);d("#popoverContent").css("border-color",c.borderColor);d(".popoverContentRow").css("border-color",c.borderColor)}d("#popover").stop(false,true).fadeIn("fast");d("#popoverWrapper").css("visibility","visible");d("#popover").promise().done(function(){});i.trigger("popover.visible");if(this._onVisible){this._onVisible()}if((this.isDataKept&&!this.hasBeenOpened)||(!this.isDataKept)){var j=this.childToAppend;if(j){this.appendChild(j)}}this.hasBeenOpened=true;c.updatePositions(f);c.lastElementClick=f.attr("id")};c.updatePositions=function(e){c.updateTopPosition(e);c.updateLeftPosition(e);d(document).trigger("popover.updatePositions")};c.updateTopPosition=function(f){var e=c.getTop(f);d("#popoverWrapper").css("padding-top",e+"px")};c.updateLeftPosition=function(e){var f=c.getLeft(e);d("#popoverWrapper").css("left",f.popoverLeft);c.setCaretPosition(f.targetLeft-f.popoverLeft+c.padding)};c.getLeft=function(g){var i=d("#popoverWrapper");c.currentTarget=g;var j=g.offset().left+g.outerWidth()/2;var f=j+i.outerWidth()/2;var h=j-i.outerWidth()/2+c.padding+1;var e=d(window).width();c.offScreenX=false;if(h<0){c.offScreenX=true;h=c.padding}else{if(f>e){c.offScreenX=true;h=e-i.outerWidth()}}return{targetLeft:j,popoverLeft:h}};c.getTop=function(j){var g=d("#popoverArrow").height();var f=(d("#popoverWrapper").css("position")==="absolute")?0:d(window).scrollTop();var l=j.offset().top-f;var k=l+j.outerHeight();var i=k+g;var e=d(window).height();var h=d("#popoverContent").height();var m=h+d("#popoverHeader").outerHeight()+g;c.above=false;c.offScreenY=false;if(e<k+m){c.offScreenY=true;if(l>=m){i=l-m;c.above=true}else{i=e-m}}else{if(i<0){c.offScreenY=true;i=c.padding+g}}return i};c.setCaretPosition=function(h){var e="50%";var g=d("#popoverArrow");if(c.offScreenX){e=h}g.css("left",e);if(c.above){var f=d("#popoverContent").outerHeight()-4;d("#popoverArrow").css("margin-top",f+"px").addClass("flipArrow").html("▼")}else{d("#popoverArrow").css("margin-top","").removeClass("flipArrow").html("▲")}c.caretLeftOffset=e};c.prototype.createPopover=function(){var g=d(document.createElement("div"));g.attr("id","popoverWrapper");var f="<div id='popover'><div id='popoverArrow'>▲</div><div id='currentPopoverAction' style='display: none;'></div><div id='popoverContentWrapper'><div id='popoverContent'></div></div></div>";g.html(f);g.find("#popover").css("display","none");d("body").prepend(g);var e=d("#popoverContentWrapper");d(window).on("resize",function(){if(d("#popover").is(":visible")){c.updatePositions(c.currentTarget)}var h=d("#popoverWrapper");if(h.css("position")==="absolute"){h.css("height",d(document).height())}else{h.css("height","")}e.trigger("popover.resize")});d("html").on("click touchend",function(l){var h=d(l.target);var k=h.parents("#popoverHeader").length+h.is("#popoverHeader")?1:0;var j=(h.parents("#popoverContentWrapper").length&&!h.parent().is("#popoverContentWrapper"))?1:0;var i=h.parents("."+c.lastPopoverClicked.popoverListenerID).length+h.is("."+c.lastPopoverClicked.popoverListenerID)?1:0;if(k===0&&j===0&&i===0){c.closePopover()}});e.trigger("popover.created");if(this._onCreate){this._onCreate()}return g};c.closePopover=function(){if(c.isLocked){return}c.lastElementClick=null;d(document).trigger("popover.closing");c.history=[];d("#popover").stop(false,true).fadeOut("fast");d("#popoverWrapper").css("visibility","hidden")};c.getAction=function(){return d("#currentPopoverAction").html()};c.setAction=function(e){d("#currentPopoverAction").html(e)};c.prototype.disableBackButton=function(){this.isBackEnabled=false};c.prototype.enableBackButton=function(){this.isBackEnabled=true};c.prototype.previousPopover=function(){c.history.pop();if(c.history.length<=0){c.closePopover();return}var e=c.history[c.history.length-1];this.populateByMenu(e)};c.setTitle=function(e){c.title=e;d("#popoverTitle").html(e)};c.getMenu=function(f){var e;for(e=0;e<c.menus.length;e+=1){if(c.menus[e].id===f){return c.menus[e]}}return null};c.addMenu=function(g,f,e){c.menus.push({id:g,title:f,contents:e})};c.prototype.populateByMenu=function(h){d(document).trigger("popover.populating");this.lastContentHeight=c.getPopoverContentHeight();if(!this.isDataKept){this.clearData()}if(!this.isHeaderDisabled&&!this.isDataKept){this.insertHeader()}else{this.removeHeader()}var f=d("#popover").css("display");if(!this.isDataKept||!this.hasBeenOpened){this.setData(h)}this.currentContentHeight=c.getPopoverContentHeight();if(c.above&&f!=="none"){var e=parseInt(d("#popoverWrapper").css("padding-top"),10);var g=this.currentContentHeight-this.lastContentHeight;var i=e-(g);d("#popoverWrapper").css("padding-top",i+"px");c.setCaretPosition(c.caretLeftOffset)}return true};c.prototype.populate=function(g){var f=null;var e=0;for(e;e<g.length;e++){f=c.getMenu(g[e]);if(f){break}}if(!f){console.log("ID not found.");return false}c.history.push(f);return this.populateByMenu(f)};c.getPopoverContentHeight=function(){var f=d("#popover").css("display");d("#popover").show();var e=d("#popoverContent").height();d("#popover").css("display",f);return e};c.prototype.insertHeader=function(){var f="<div id='popoverHeader'><div id='popoverTitle'></div><a id='popoverClose'><span id='popoverCloseIcon'>✕</span></a></div>";d("#popoverContentWrapper").before(f);if(this.isBackEnabled){var e=this;d("#popoverHeader").prepend("<a id='popoverBack'><span id='popoverBackIcon'>&#x25C0;</span></a>");d("#popoverBack").on("click",function(){e.previousPopover()})}d("#popoverClose").on("click",function(){c.closePopover()});d("#popoverContent").css("paddingTop","47px")};c.prototype.removeHeader=function(){d("#popoverBack").off("click");d("#popoverClose").off("click");d("#popoverHeader").remove();d("#popoverContent").css("paddingTop","")};c.prototype.clearData=function(){this.removeHeader();d("#popoverTitle").html("");d("#popoverContent").html("")};c.prototype.setData=function(e){c.setAction(e.id);c.setTitle(e.title);c.setContent(e.contents)};c.prototype.replaceMenu=function(g,f){var e;for(e in g){delete g[e]}for(e in f){g[e]=f[e]}};c.setContent=function(e){c.content=e;d("#popoverContent").html(e);d("#popoverContentWrapper").trigger("popover.setContent")};c.popoverNum=0;c.lastElementClick=null;c.currentTarget=null;c.title="";c.content="";c.menus=[];c.history=[];c.backgroundColor=null;c.fontColor=null;c.borderColor=null;c.padding=3;c.offScreenX=false;c.offScreenY=false;c.isLocked=false;c.above=false;c.caretLeftOffset="50%";c.lastPopoverClicked=null;c.setBackgroundColor=function(e){c.backgroundColor=e};c.setFontColor=function(e){c.fontColor=e};c.setBorderColor=function(e){c.borderColor=e};c.lockPopover=function(){c.isLocked=true};c.unlockPopover=function(){c.isLocked=false};function b(e){c.apply(this,[e]);this.constructor=b;this.superConstructor=c;this.isHeaderDisabled=false;this.isBackEnabled=true;if(!b.hasRun){this.init();b.hasRun=true}}b.prototype=new c();b.constructor=b;b.hasRun=false;b.prototype.init=function(){d(document).on("touchstart mousedown","#popover a",function(){d(this).css({backgroundColor:"#488FCD"})}).on("touchend mouseup mouseout","#popover a",function(){d(this).css({backgroundColor:""})}).on("click",".popoverContentRow",function(){var f=[];f.push(d(this).attr("id"));if(d(this).hasClass("popoverEvent")){d(this).trigger("popover.action",d(this))}var e=c.lastPopoverClicked.populate(f);if(!e){c.closePopover()}})};b.prototype.setData=function(h){var g=h.contents;var m="";var f;for(f=0;f<g.length;f++){var l="";var j="";var k="";var e="";if(f===g.length-1){l=" last"}if(typeof(g[f].id)!=="undefined"){k=" id='"+g[f].id+"'"}if(typeof(g[f].url)!=="undefined"){e=" href='"+g[f].url+"'"}else{j=" popoverEvent"}m+="<a"+e+k+" class='popoverContentRow"+j+l+"'>"+g[f].name+"</a>"}c.setAction(h.id);c.setTitle(h.title);c.setContent(m)}}(window.jQuery);